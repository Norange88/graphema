"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Cart=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"init",value:function(){this.appendProducts(this.getItemsFromLS("_cart")),this.bindEvents(),this.setTotal(this.countTotal()),console.log(this.countTotal())}},{key:"getItemsFromLS",value:function(a){return JSON.parse(localStorage.getItem(a))}},{key:"loadProducts",value:function(a){var b=this;return a.reduce(function(a,c,d){return a+=b.createProductTemplate(c,d)},"")}},{key:"createProductTemplate",value:function(a,b){return'<div class="cart__item" data-item-id="'+a.id+'">\n\t\t\t\t\t\t\t<img class="cart__item-img" src="'+a.picture+'" alt="cart" width="100" height="66">\n\t\t\t\t\t\t\t<p class="cart__item-name">'+a.name+'</p>\n\t\t\t\t\t\t\t<button class="cart__item-remove">[Remove]</button>\n\t\t\t\t\t\t\t<p class="cart__item-price">Â£<span>'+a.price+'.00</span></p>\n\t\t\t\t\t\t\t<input type="number" class="cart__items-count" value="'+a.count+'">\n\t\t\t\t\t\t</div>'}},{key:"appendProducts",value:function(a){document.querySelector(".cart__item-list").innerHTML=this.loadProducts(a)}},{key:"countTotal",value:function(a){a=a||this.getItemsFromLS("_cart");return a.reduce(function(a,b){return a+=b.price*b.count},0)}},{key:"setTotal",value:function(a){document.querySelector(".cart__total-price span").innerHTML=a||0}},{key:"getItemByID",value:function(a,b){return b[a]}},{key:"bindEvents",value:function(){var a=this;document.querySelector(".cart__checkout").onclick=function(){return!1};var b=document.querySelector(".cart__item-list");b.addEventListener("click",function(b){var c=b.target;if(c.classList.contains("cart__item-remove")){var d=+c.closest(".cart__item").getAttribute("data-item-id");a.getItemByID(d,a.getItemsFromLS("_cart"));a.removeItemFromCart(d),a.removeItemNode(c),a.setTotal(a.countTotal())}}),b.addEventListener("blur",function(b){var c=b.target;if(c.classList.contains("cart__items-count")){var d=c.value;c.setAttribute("value",d);var e=+c.closest(".cart__item").getAttribute("data-item-id");a.changeCartItemCount(e,d),a.setTotal(a.countTotal())}},!0)}},{key:"changeCartItemCount",value:function(a,b){for(var c=this.getItemsFromLS("_cart"),d=0;d<c.length;d++)if(a===c[d].id){c[d].count=b;break}this.setItemsToLS("_cart",c)}},{key:"removeItemFromCart",value:function(a,b){b=b||this.getItemsFromLS("_cart");var c=b.findIndex(function(b){return b.id==a});c!==-1&&b.splice(c,1),this.setItemsToLS("_cart",b)}},{key:"removeItemNode",value:function(a){a.closest(".cart__item").remove()}},{key:"setItemsToLS",value:function(a,b){localStorage.setItem(a,JSON.stringify(b))}}]),a}();document.addEventListener("DOMContentLoaded",function(){(new Cart).init()});