"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),App=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"init",value:function(){var a=this;this.loadData("items.json").then(function(b){a.setItemsToLS("_products",a.convertItems(b)),a.appendProducts(b)}),this.bindEvents(".products__item-list")}},{key:"loadData",value:function(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.responseType="json",d.open("GET",a,!0),d.onload=function(){200===d.status?b(d.response):c(d)},d.onerror=c,d.send()})}},{key:"convertItems",value:function(a){return a.map(function(a,b){return a.id=b,a})}},{key:"loadProducts",value:function(a){var b=this;return a.reduce(function(a,c,d){return a+=b.createProductTemplate(c,d)},"")}},{key:"appendProducts",value:function(a){document.querySelector(".products__item-list").innerHTML=this.loadProducts(a)}},{key:"getItemsFromLS",value:function(a){return JSON.parse(localStorage.getItem(a))}},{key:"setItemsToLS",value:function(a,b){localStorage.setItem(a,JSON.stringify(b))}},{key:"getItemByID",value:function(a,b){return b[a]}},{key:"createProductTemplate",value:function(a){return'<div class="products__item" data-item-id="'+a.id+'">\n\t\t\t\t<img class="products__item-picture" src="'+a.picture+'" alt="product" width="360" height="240">\n\t\t\t\t<div class="products__item-content-wrap">\n\t\t\t\t\t<p class="products__item-name">'+a.name+'</p>\n\t\t\t\t\t<p class="products__item-color">'+a.color+'</p>\n\t\t\t\t\t<p class="products__item-size">\n\t\t\t\t\t\t<span>Size: '+a.size+'</span>\n\t\t\t\t\t\t<a href="#" class="products__item-size-change">[Change]</a>\n\t\t\t\t\t</p>\n\t\t\t\t\t<footer class="products__item-foooter">\n\t\t\t\t\t\t<p class="products__item-price">Â£'+a.price+'.00</p>\n\t\t\t\t\t\t<button class="btn btn--blue">add to basket</button>\n\t\t\t\t\t</footer>\n\t\t\t\t</div>\n\t\t\t</div>'}},{key:"bindEvents",value:function(a){var b=this,c=document.querySelector(a);c.addEventListener("click",function(a){var c=a.target;if("BUTTON"===c.tagName){var d=+c.closest(".products__item").getAttribute("data-item-id"),e=b.getItemByID(d,b.getItemsFromLS("_products"));b.addItemToCart(e)}return!1})}},{key:"addItemToCart",value:function(a){a.count=1;var b=this.getItemsFromLS("_cart");if(b){var c=b.find(function(b){return b.id===a.id});c?c.count++:b.push(a)}else b=[a];this.setItemsToLS("_cart",b)}}]),a}();document.addEventListener("DOMContentLoaded",function(){(new App).init()});